# PodDisruptionBudget â€” guarantees at least 1 identity-service pod is always running
# during voluntary disruptions (node drains, cluster upgrades, rolling updates).
# Without this, a node drain on a 2-replica deployment could take both pods offline.
apiVersion: policy/v1
kind: PodDisruptionBudget
metadata:
  name: identity-service-pdb
  namespace: app
spec:
  minAvailable: 1       # Always keep at least 1 pod running
  selector:
    matchLabels:
      app: identity-service
